name: Test
on: [push]

jobs:
  testing:
    runs-on: ubuntu-latest
    
    steps:
    - name: git pull
      uses: actions/checkout@v1
    - name: list files
      run: ls -l
      
    - name: Set env
      run: echo "REMOTE_HOST=$(cat ec2_dns_name)" >> $GITHUB_ENV
    - name: test
      run: echo ${{ env.REMOTE_HOST }}
    - name: ssh deploy
      uses: easingthemes/ssh-deploy@v2.2.11
      with:
          SSH_PRIVATE_KEY: ${{ secrets.EC2_SSH_KEY }}
          SOURCE: "./"
          #REMOTE_HOST: ${{ env.REMOTE_HOST }}
          REMOTE_USER: "ubuntu"
          TARGET: "/git/test"      
